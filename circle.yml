dependencies:
  post:
    # install golint
    - go get github.com/golang/lint/golint
    # install gox
    - go get -u -f github.com/mitchellh/gox
    # install binaries
    - go install ./...

test:
  pre:
    # Go fmt should pass all files
    - "[ `git ls-files | grep '.go$' | xargs gofmt -l 2>&1 | wc -l` -eq 0 ]"
    - go vet ./...
    - golint .
    - golint testutil/...
    - golint cmd/...
  override:
    - make test-short
  post:
    - gox -os="linux" -arch="386 amd64" ./...
    - mv telegraf* $CIRCLE_ARTIFACTS
